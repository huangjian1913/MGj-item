"use strict";!function(){var r=location.search.substring(1).split("=")[1],o=document.querySelector(".detailpart .detail_left .bigpicbox img"),c=document.querySelectorAll(".detailpart .detail_left .smallbox img"),l=document.querySelector(".detailpart .detail_left .zoombox img"),a=document.querySelector(".detailpart .numbox span"),e=document.querySelector(".detailpart .detail_mid .addcart .add"),s=document.querySelector(".storepic .bigpic img"),n=document.querySelector(".detailpart .detail_mid p"),t=document.querySelectorAll(".detailpart .detail_mid .message p"),d=t[0].querySelector("span"),u=t[1].querySelector("span"),p=t[2].querySelectorAll("span")[1];$ajax({url:"http://10.31.162.38/Mogujie/php/detail.php",data:{sid:r}}).then(function(e){var t=JSON.parse(e);o.src=t.url,l.src=o.src,c[0].src=t.url1,c[1].src=t.url2,c[2].src=t.url3,c[3].src=t.url4,c[4].src=t.url,n.innerHTML=t.title,d.innerHTML="¥"+t.oldprice,u.innerHTML="¥"+t.price,p.innerHTML=t.sailnumber,s.src=t.piclisturl;for(var i=0;i<c.length;i++)c[i].onmousemove=function(){o.src=this.src,l.src=o.src}});var m=[],h=[],f=[],g=[];e.addEventListener("click",function(){var e,t,i=document.querySelector(".detailpart .color .color_select .active"),o=document.querySelector(".detailpart .size .size_select .active");i&&o&&(g=cookie.get("cookiesid")&&cookie.get("cookienum")&&cookie.get("cookiecolor")&&cookie.get("cookiesize")?(m=cookie.get("cookiesid").split(","),h=cookie.get("cookienum").split(","),f=cookie.get("cookiecolor").split(","),cookie.get("cookiesize").split(",")):(m=[],h=[],f=[],[]),-1!==m.indexOf(r)&&f[m.indexOf(r)]===i.innerHTML&&g[m.indexOf(r)]===o.innerHTML?(e=parseInt(h[m.indexOf(r)])+parseInt(a.innerHTML),h[m.indexOf(r)]=e,cookie.set("cookienum",h,10)):(m.push(r),t=parseInt(a.innerHTML),h.push(t),f.push(i.innerHTML),g.push(o.innerHTML),cookie.set("cookiesid",m,10),cookie.set("cookienum",h,10),cookie.set("cookiecolor",f,10),cookie.set("cookiesize",g,10)),alert("商品成功加入购物车"))})}(),function(){var p=$(".detailpart .color .color_select .xuxian").siblings("p"),m=$(".detailpart .size .size_select p");p.on("click",function(){$(this).hasClass("active")?$(this).removeClass("active"):$(this).addClass("active").siblings(".detailpart .color .color_select p").removeClass("active")}),m.on("click",function(){$(this).hasClass("active")?$(this).removeClass("active"):$(this).addClass("active").siblings(".detailpart .size .size_select p").removeClass("active")});var e=document.querySelectorAll(".detailpart .number p")[1],t=document.querySelectorAll(".detailpart .number p")[0],h=document.querySelector(".detailpart .numbox span"),i=document.querySelector(".detailpart .detail_mid .addcart .add"),f=document.querySelector(".header .header-wrap .gouwuche");e.onclick=function(){h.innerHTML=parseInt(h.innerHTML)+1},t.onclick=function(){parseInt(h.innerHTML)<=1?h.innerHTML=1:h.innerHTML=parseInt(h.innerHTML)-1};i.addEventListener("click",function(e){var t,i,o,r,c,l,a,s,n,d,u;!(!p.hasClass("active")||!m.hasClass("active"))&&(t=(e=e||window.event).clientX,i=e.clientY+scrollY,o=f.offsetLeft,r=f.offsetTop,a=-((r-(l=r-400))*t-(o-(c=o-400))*i+o*l-c*r)/((o-c)*(t-o)*(t-c)),s=((r-l)*t*t+o*o*l-c*c*r-(o*o-c*c)*i)/((o-c)*(t-o)*(t-c)),n=((o*l-c*r)*t*t-(o*o*l-c*c*r)*t+(o*o*c-o*c*c)*i)/((o-c)*(t-o)*(t-c)),(d=document.createElement("div")).className="cart_active",d.innerHTML=h.innerHTML,document.body.appendChild(d),d.style.left=t+"px",d.style.top=i+"px",u=setInterval(function(){i=a*(t+=10)*t+s*t+n,d.style.left=t+"px",d.style.top=i+"px",o<=t&&(clearInterval(u),d.remove())},60))},!0)}(),function(e){var r=e(".detailpart .detail_left"),c=e(".detailpart .detail_left .bigpicbox"),l=e(".detailpart .detail_left .bigpicbox .zoom"),t=(e(".detailpart .detail_left .bigpicbox img"),e(".detailpart .detail_left .zoombox")),a=e(".detailpart .detail_left .zoombox img");c.hover(function(){l.css("display","block"),t.css("display","block"),l.css({width:c.outerWidth()*t.outerWidth()/a.outerWidth(),height:c.outerHeight()*t.outerHeight()/a.outerHeight()});var o=a.outerWidth()/c.outerWidth();e(this).on("mousemove",function(e){var t=e.pageX-r.offset().left-l.outerWidth()/2,i=e.pageY-r.offset().top-l.outerHeight()/2;t<0?t=0:t>=c.outerWidth()-l.outerWidth()&&(t=c.outerWidth()-l.outerWidth()),i<0?i=0:i>=c.outerHeight()-l.outerHeight()&&(i=c.outerHeight()-l.outerHeight()),l.css({left:t,top:i}),a.css({left:-o*t,top:-o*i})})},function(){l.css("display","none"),t.css("display","none")})}(jQuery);