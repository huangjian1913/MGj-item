"use strict";!function(r){var c,l,p,s,d=r(".cart_wrap .cart_list");function h(){var c=0,o=0;r(".cart_wrap nav:visible").each(function(i,e){r(e).find("li input:eq(0)").prop("checked")&&(c+=parseInt(r(e).find("li input:eq(1)").val()),o+=parseFloat(r(e).find(".list_total p").html()))}),r(".cart_footer p").eq(4).find("span").html(c),r(".cart_footer p").eq(5).find("span").html(o.toFixed(2))}r.cookie("cookiesid")&&r.cookie("cookienum")&&r.cookie("cookiecolor")&&r.cookie("cookiesize")&&(c=r.cookie("cookiesid").split(","),l=r.cookie("cookienum").split(","),p=r.cookie("cookiecolor").split(","),s=r.cookie("cookiesize").split(","),r.each(c,function(i,e){var o,n,t,a;o=c[i],n=l[i],t=p[i],a=s[i],r.ajax({url:"http://10.31.162.38/Mogujie/php/alldata.php",dataType:"json"}).done(function(i){r.each(i,function(i,e){var c;o==e.sid&&((c=r(".cart_wrap nav:hidden").clone(!0,!0)).find(":checkbox").attr("checked","checked"),c.find(".pic").find("img").attr("src",e.url),c.find(".pic").find("p").html(e.title),c.find(".pic").find("img").attr("sid",e.sid),c.find(".list_message").children().eq(0).find("span").html(t),c.find(".list_message").children().eq(1).find("span").html(a),c.find(".list_price").children().eq(0).html(e.oldprice),c.find(".list_price").children().eq(1).html(e.price),c.find(".list_num").find("input").val(n),c.find(".list_total").find("p").html((e.price*n).toFixed(2)),c.css("display","block"),d.append(c),h())}),0<r(".cart_wrap nav:visible").length&&r(".cart_wrap nav:visible").find(":checkbox").length===r(".cart_wrap nav:visible").find("input:checked").size()?r(".allsel").prop("checked",!0):r(".allsel").prop("checked",!1)})})),r(".allsel").on("change",function(){r(".cart_wrap nav:visible").find(":checkbox").prop("checked",r(this).prop("checked")),r(".allsel").prop("checked",r(this).prop("checked")),h(),r(this).prop("checked")?r(".cart_footer p:eq(6)").css({background:"red"}):r(".cart_footer p:eq(6)").css({background:"#999"})});var i=r(".cart_wrap nav:visible").find(":checkbox");r(".cart_list").on("change",i,function(i){r(".cart_wrap nav:visible").find(":checkbox").length===r(".cart_wrap nav:visible").find("input:checked").size()?r(".allsel").prop("checked",!0):r(".allsel").prop("checked",!1),h(),1<=r(".cart_wrap nav:visible").find("input:checked").size()?r(".cart_footer p:eq(6)").css({background:"red"}):0===r(".cart_wrap nav:visible").find("input:checked").size()&&r(".cart_footer p:eq(6)").css({background:"#999"})}),r(".list_num input").on("change",function(i){i=i||window.event;var e=r(i.target)||r(i.srcElement);e.val()<1&&e.val(1);var c=e.parents("li").find(".list_price").find("p").html();e.parents("li").find(".list_total").find("p").html(parseFloat(e.val()*c).toFixed(2)),h(),function(i){a();var e=i.parents("li").find("img").attr("sid");n[r.inArray(e,o)]=i.parents("li").find(".list_num").find("input").val(),r.cookie("cookienum",n,{expires:10,path:"/"})}(e)});var o=[],n=[],e=[],t=[];function a(){t=r.cookie("cookiesid")&&r.cookie("cookienum")?(o=r.cookie("cookiesid").split(","),n=r.cookie("cookienum").split(","),e=r.cookie("cookiecolor").split(","),r.cookie("cookiesize").split(",")):(o=[],n=[],e=[],[])}function k(c,i){var o=-1;r.each(i,function(i,e){c===e&&(o=i)}),i.splice(o,1),n.splice(o,1),e.splice(o,1),t.splice(o,1),r.cookie("cookiesid",i,{expires:10,path:"/"}),r.cookie("cookienum",n,{expires:10,path:"/"}),r.cookie("cookiecolor",e,{expires:10,path:"/"}),r.cookie("cookiesize",t,{expires:10,path:"/"})}r("li a").on("click",function(){a(),window.confirm("你确定要删除吗?")&&(r(this).parents("nav").remove(),k(r(this).parents("li").find("img").attr("sid"),o),h()),0==r(".cart_wrap nav:visible").length&&r(".allsel").prop("checked",!1)}),r(".cart_footer p:eq(1)").on("click",function(){a(),window.confirm("你确定要删除选中的吗?")&&(r("nav:visible").each(function(){r(this).find(":checkbox").is(":checked")&&(r(this).remove(),k(r(this).find("img").attr("sid"),o))}),h()),0==r(".cart_wrap nav:visible").length&&r(".allsel").prop("checked",!1)})}(jQuery);